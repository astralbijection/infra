# THIS IS AN AUTO-GENERATED FILE. You should edit /nix/ci.nix instead.

env:
  target_flake: github:${{ github.repository }}/${{ inputs.sha || github.sha }}
jobs:
  build-devShells-x86_64-darwin:
    name: DevShells x86_64-darwin
    needs: []
    runs-on: macos-latest
    steps:
      - uses: cachix/install-nix-action@v16
        with:
          extra_nix_config: 'experimental-features = nix-command flakes

            access-tokens = github.com=${{ secrets.GITHUB_TOKEN }}

            '
          nix_path: nixpkgs=channel:nixos-unstable
      - uses: cachix/cachix-action@v10
        with:
          authToken: ${{ secrets.CACHIX_AUTH_TOKEN }}
          name: astralbijection
      - env:
          target_flake: ${{ env.target_flake }}
        name: Build targets
        run: GC_DONT_GC=1 nix build --show-trace "$target_flake#"'devShells.x86_64-darwin.default'
    strategy:
      fail-fast: false
  build-devShells-x86_64-linux:
    name: DevShells x86_64-linux
    needs: []
    runs-on: ubuntu-latest
    steps:
      - uses: cachix/install-nix-action@v16
        with:
          extra_nix_config: 'experimental-features = nix-command flakes

            access-tokens = github.com=${{ secrets.GITHUB_TOKEN }}

            '
          nix_path: nixpkgs=channel:nixos-unstable
      - uses: cachix/cachix-action@v10
        with:
          authToken: ${{ secrets.CACHIX_AUTH_TOKEN }}
          name: astralbijection
      - env:
          target_flake: ${{ env.target_flake }}
        name: Build targets
        run: GC_DONT_GC=1 nix build --show-trace "$target_flake#"'devShells.x86_64-linux.default'
    strategy:
      fail-fast: false
  build-home-manager-x86_64-darwin:
    name: Home cfgs. x86_64-darwin
    needs: []
    runs-on: macos-latest
    steps:
      - uses: cachix/install-nix-action@v16
        with:
          extra_nix_config: 'experimental-features = nix-command flakes

            access-tokens = github.com=${{ secrets.GITHUB_TOKEN }}

            '
          nix_path: nixpkgs=channel:nixos-unstable
      - uses: cachix/cachix-action@v10
        with:
          authToken: ${{ secrets.CACHIX_AUTH_TOKEN }}
          name: astralbijection
      - env:
          target_flake: ${{ env.target_flake }}
        name: Build targets
        run: GC_DONT_GC=1 nix build --show-trace "$target_flake#"'homeConfigurations.astrid@soulcaster.activationPackage'
    strategy:
      fail-fast: false
  build-home-manager-x86_64-linux:
    name: Home cfgs. x86_64-linux
    needs: []
    runs-on: ubuntu-latest
    steps:
      - uses: cachix/install-nix-action@v16
        with:
          extra_nix_config: 'experimental-features = nix-command flakes

            access-tokens = github.com=${{ secrets.GITHUB_TOKEN }}

            '
          nix_path: nixpkgs=channel:nixos-unstable
      - uses: cachix/cachix-action@v10
        with:
          authToken: ${{ secrets.CACHIX_AUTH_TOKEN }}
          name: astralbijection
      - env:
          target_flake: ${{ env.target_flake }}
        name: Build targets
        run: GC_DONT_GC=1 nix build --show-trace "$target_flake#"'homeConfigurations.astrid@Discovery.activationPackage'
          "$target_flake#"'homeConfigurations.astrid@aliaconda.activationPackage'
          "$target_flake#"'homeConfigurations.astrid@banana.activationPackage' "$target_flake#"'homeConfigurations.astrid@chungus.activationPackage'
          "$target_flake#"'homeConfigurations.astrid@shai-hulud.activationPackage'
          "$target_flake#"'homeConfigurations.default.activationPackage'
    strategy:
      fail-fast: false
  build-installer-iso:
    name: x86 Installer ISO
    needs:
      - build-nixos-system-__base
      - build-home-manager-x86_64-linux
    runs-on: ubuntu-latest
    steps:
      - uses: cachix/install-nix-action@v16
        with:
          extra_nix_config: 'experimental-features = nix-command flakes

            access-tokens = github.com=${{ secrets.GITHUB_TOKEN }}

            '
          nix_path: nixpkgs=channel:nixos-unstable
      - uses: cachix/cachix-action@v10
        with:
          authToken: ${{ secrets.CACHIX_AUTH_TOKEN }}
          name: astralbijection
      - env:
          target_flake: ${{ env.target_flake }}
        name: Build targets
        run: GC_DONT_GC=1 nix build --show-trace "$target_flake#"'packages.x86_64-linux.installer-iso'
    strategy:
      fail-fast: false
  build-nixos-system-__base:
    name: NixOS sys. __base
    needs: []
    runs-on: ubuntu-latest
    steps:
      - uses: cachix/install-nix-action@v16
        with:
          extra_nix_config: 'experimental-features = nix-command flakes

            access-tokens = github.com=${{ secrets.GITHUB_TOKEN }}

            '
          nix_path: nixpkgs=channel:nixos-unstable
      - uses: cachix/cachix-action@v10
        with:
          authToken: ${{ secrets.CACHIX_AUTH_TOKEN }}
          name: astralbijection
      - env:
          target_flake: ${{ env.target_flake }}
        name: Build targets
        run: GC_DONT_GC=1 nix build --show-trace "$target_flake#"'nixosConfigurations.__base.config.system.build.toplevel'
    strategy:
      fail-fast: false
  build-nixos-system-__basePC:
    name: NixOS sys. __basePC
    needs:
      - build-nixos-system-__base
    runs-on: ubuntu-latest
    steps:
      - uses: cachix/install-nix-action@v16
        with:
          extra_nix_config: 'experimental-features = nix-command flakes

            access-tokens = github.com=${{ secrets.GITHUB_TOKEN }}

            '
          nix_path: nixpkgs=channel:nixos-unstable
      - uses: cachix/cachix-action@v10
        with:
          authToken: ${{ secrets.CACHIX_AUTH_TOKEN }}
          name: astralbijection
      - env:
          target_flake: ${{ env.target_flake }}
        name: Build targets
        run: GC_DONT_GC=1 nix build --show-trace "$target_flake#"'nixosConfigurations.__basePC.config.system.build.toplevel'
    strategy:
      fail-fast: false
  build-nixos-system-__baseServer:
    name: NixOS sys. __baseServer
    needs:
      - build-home-manager-x86_64-linux
      - build-nixos-system-__base
    runs-on: ubuntu-latest
    steps:
      - uses: cachix/install-nix-action@v16
        with:
          extra_nix_config: 'experimental-features = nix-command flakes

            access-tokens = github.com=${{ secrets.GITHUB_TOKEN }}

            '
          nix_path: nixpkgs=channel:nixos-unstable
      - uses: cachix/cachix-action@v10
        with:
          authToken: ${{ secrets.CACHIX_AUTH_TOKEN }}
          name: astralbijection
      - env:
          target_flake: ${{ env.target_flake }}
        name: Build targets
        run: GC_DONT_GC=1 nix build --show-trace "$target_flake#"'nixosConfigurations.__baseServer.config.system.build.toplevel'
    strategy:
      fail-fast: false
  build-nixos-system-banana:
    name: NixOS sys. banana
    needs:
      - build-nixos-system-__basePC
    runs-on: ubuntu-latest
    steps:
      - uses: cachix/install-nix-action@v16
        with:
          extra_nix_config: 'experimental-features = nix-command flakes

            access-tokens = github.com=${{ secrets.GITHUB_TOKEN }}

            '
          nix_path: nixpkgs=channel:nixos-unstable
      - uses: cachix/cachix-action@v10
        with:
          authToken: ${{ secrets.CACHIX_AUTH_TOKEN }}
          name: astralbijection
      - env:
          target_flake: ${{ env.target_flake }}
        name: Build targets
        run: GC_DONT_GC=1 nix build --show-trace "$target_flake#"'nixosConfigurations.banana.config.system.build.toplevel'
    strategy:
      fail-fast: false
  build-nixos-system-bennett:
    name: NixOS sys. bennett
    needs:
      - build-nixos-system-__baseServer
    runs-on: ubuntu-latest
    steps:
      - uses: cachix/install-nix-action@v16
        with:
          extra_nix_config: 'experimental-features = nix-command flakes

            access-tokens = github.com=${{ secrets.GITHUB_TOKEN }}

            '
          nix_path: nixpkgs=channel:nixos-unstable
      - uses: cachix/cachix-action@v10
        with:
          authToken: ${{ secrets.CACHIX_AUTH_TOKEN }}
          name: astralbijection
      - env:
          target_flake: ${{ env.target_flake }}
        name: Build targets
        run: GC_DONT_GC=1 nix build --show-trace "$target_flake#"'nixosConfigurations.bennett.config.system.build.toplevel'
    strategy:
      fail-fast: false
  build-nixos-system-chungus:
    name: NixOS sys. chungus
    needs:
      - build-nixos-system-__basePC
    runs-on: ubuntu-latest
    steps:
      - uses: cachix/install-nix-action@v16
        with:
          extra_nix_config: 'experimental-features = nix-command flakes

            access-tokens = github.com=${{ secrets.GITHUB_TOKEN }}

            '
          nix_path: nixpkgs=channel:nixos-unstable
      - uses: cachix/cachix-action@v10
        with:
          authToken: ${{ secrets.CACHIX_AUTH_TOKEN }}
          name: astralbijection
      - env:
          target_flake: ${{ env.target_flake }}
        name: Build targets
        run: GC_DONT_GC=1 nix build --show-trace "$target_flake#"'nixosConfigurations.chungus.config.system.build.toplevel'
    strategy:
      fail-fast: false
  build-nixos-system-diluc:
    name: NixOS sys. diluc
    needs:
      - build-nixos-system-__baseServer
    runs-on: ubuntu-latest
    steps:
      - uses: cachix/install-nix-action@v16
        with:
          extra_nix_config: 'experimental-features = nix-command flakes

            access-tokens = github.com=${{ secrets.GITHUB_TOKEN }}

            '
          nix_path: nixpkgs=channel:nixos-unstable
      - uses: cachix/cachix-action@v10
        with:
          authToken: ${{ secrets.CACHIX_AUTH_TOKEN }}
          name: astralbijection
      - env:
          target_flake: ${{ env.target_flake }}
        name: Build targets
        run: GC_DONT_GC=1 nix build --show-trace "$target_flake#"'nixosConfigurations.diluc.config.system.build.toplevel'
    strategy:
      fail-fast: false
  build-nixos-system-donkey:
    name: NixOS sys. donkey
    needs:
      - build-nixos-system-__baseServer
    runs-on: ubuntu-latest
    steps:
      - uses: cachix/install-nix-action@v16
        with:
          extra_nix_config: 'experimental-features = nix-command flakes

            access-tokens = github.com=${{ secrets.GITHUB_TOKEN }}

            '
          nix_path: nixpkgs=channel:nixos-unstable
      - uses: cachix/cachix-action@v10
        with:
          authToken: ${{ secrets.CACHIX_AUTH_TOKEN }}
          name: astralbijection
      - env:
          target_flake: ${{ env.target_flake }}
        name: Build targets
        run: GC_DONT_GC=1 nix build --show-trace "$target_flake#"'nixosConfigurations.donkey.config.system.build.toplevel'
    strategy:
      fail-fast: false
  build-nixos-system-durin:
    name: NixOS sys. durin
    needs:
      - build-nixos-system-__baseServer
    runs-on: ubuntu-latest
    steps:
      - uses: cachix/install-nix-action@v16
        with:
          extra_nix_config: 'experimental-features = nix-command flakes

            access-tokens = github.com=${{ secrets.GITHUB_TOKEN }}

            '
          nix_path: nixpkgs=channel:nixos-unstable
      - uses: cachix/cachix-action@v10
        with:
          authToken: ${{ secrets.CACHIX_AUTH_TOKEN }}
          name: astralbijection
      - env:
          target_flake: ${{ env.target_flake }}
        name: Build targets
        run: GC_DONT_GC=1 nix build --show-trace "$target_flake#"'nixosConfigurations.durin.config.system.build.toplevel'
    strategy:
      fail-fast: false
  build-nixos-system-gfdesk:
    name: NixOS sys. gfdesk
    needs:
      - build-nixos-system-__baseServer
    runs-on: ubuntu-latest
    steps:
      - uses: cachix/install-nix-action@v16
        with:
          extra_nix_config: 'experimental-features = nix-command flakes

            access-tokens = github.com=${{ secrets.GITHUB_TOKEN }}

            '
          nix_path: nixpkgs=channel:nixos-unstable
      - uses: cachix/cachix-action@v10
        with:
          authToken: ${{ secrets.CACHIX_AUTH_TOKEN }}
          name: astralbijection
      - env:
          target_flake: ${{ env.target_flake }}
        name: Build targets
        run: GC_DONT_GC=1 nix build --show-trace "$target_flake#"'nixosConfigurations.gfdesk.config.system.build.toplevel'
    strategy:
      fail-fast: false
  build-nixos-system-shai-hulud:
    name: NixOS sys. shai-hulud
    needs:
      - build-nixos-system-__basePC
      - build-surface-kernel
    runs-on: ubuntu-latest
    steps:
      - uses: cachix/install-nix-action@v16
        with:
          extra_nix_config: 'experimental-features = nix-command flakes

            access-tokens = github.com=${{ secrets.GITHUB_TOKEN }}

            '
          nix_path: nixpkgs=channel:nixos-unstable
      - uses: cachix/cachix-action@v10
        with:
          authToken: ${{ secrets.CACHIX_AUTH_TOKEN }}
          name: astralbijection
      - env:
          target_flake: ${{ env.target_flake }}
        name: Build targets
        run: GC_DONT_GC=1 nix build --show-trace "$target_flake#"'nixosConfigurations.shai-hulud.config.system.build.toplevel'
    strategy:
      fail-fast: false
  build-nixos-system-thonkpad:
    name: NixOS sys. thonkpad
    needs:
      - build-nixos-system-__baseServer
    runs-on: ubuntu-latest
    steps:
      - uses: cachix/install-nix-action@v16
        with:
          extra_nix_config: 'experimental-features = nix-command flakes

            access-tokens = github.com=${{ secrets.GITHUB_TOKEN }}

            '
          nix_path: nixpkgs=channel:nixos-unstable
      - uses: cachix/cachix-action@v10
        with:
          authToken: ${{ secrets.CACHIX_AUTH_TOKEN }}
          name: astralbijection
      - env:
          target_flake: ${{ env.target_flake }}
        name: Build targets
        run: GC_DONT_GC=1 nix build --show-trace "$target_flake#"'nixosConfigurations.thonkpad.config.system.build.toplevel'
    strategy:
      fail-fast: false
  build-nixos-system-yato:
    name: NixOS sys. yato
    needs:
      - build-nixos-system-__baseServer
    runs-on: ubuntu-latest
    steps:
      - uses: cachix/install-nix-action@v16
        with:
          extra_nix_config: 'experimental-features = nix-command flakes

            access-tokens = github.com=${{ secrets.GITHUB_TOKEN }}

            '
          nix_path: nixpkgs=channel:nixos-unstable
      - uses: cachix/cachix-action@v10
        with:
          authToken: ${{ secrets.CACHIX_AUTH_TOKEN }}
          name: astralbijection
      - env:
          target_flake: ${{ env.target_flake }}
        name: Build targets
        run: GC_DONT_GC=1 nix build --show-trace "$target_flake#"'nixosConfigurations.yato.config.system.build.toplevel'
    strategy:
      fail-fast: false
  build-surface-kernel:
    name: Surface Kernel
    needs: []
    runs-on: ubuntu-latest
    steps:
      - uses: cachix/install-nix-action@v16
        with:
          extra_nix_config: 'experimental-features = nix-command flakes

            access-tokens = github.com=${{ secrets.GITHUB_TOKEN }}

            '
          nix_path: nixpkgs=channel:nixos-unstable
      - uses: cachix/cachix-action@v10
        with:
          authToken: ${{ secrets.CACHIX_AUTH_TOKEN }}
          name: astralbijection
      - env:
          target_flake: ${{ env.target_flake }}
        name: Build targets
        run: GC_DONT_GC=1 nix build --show-trace "$target_flake#"'nixosConfigurations.shai-hulud.config.boot.kernelPackages.kernel'
    strategy:
      fail-fast: false
on:
  push: {}
  schedule:
    - cron: 0 6 * * 6
  workflow_call:
    inputs:
      sha:
        required: true
        type: string
  workflow_dispatch: {}
